<?xml version="1.0"?>
<layout version="0.1.0">
    <!-- AjaxPro -->
    <default>

        <reference name="head">
            <action method="addItem" ifconfig="ajax_pro/general/enabled"><type>skin_css</type><name>css/ajaxpro.css</name></action>
            <action method="addItem" ifconfig="ajax_pro/general/enabled"><type>skin_js</type><name>js/ajaxpro.js</name></action>
            <action method="addItem" ifconfig="ajax_pro/general/enabled"><type>skin_js</type><name>js/ajaxpro/effect.js</name></action>
        </reference>

        <reference  name="top.container">
            <block type="checkout/cart_sidebar" name="headerCart" as="headerCart" template="ajaxpro/top/headerCart.phtml" before="-">
                <action method="addItemRender"><type>simple</type><block>checkout/cart_item_renderer</block><template>checkout/cart/sidebar/default.phtml</template></action>
                <action method="addItemRender"><type>grouped</type><block>checkout/cart_item_renderer_grouped</block><template>checkout/cart/sidebar/default.phtml</template></action>
                <action method="addItemRender"><type>configurable</type><block>checkout/cart_item_renderer_configurable</block><template>checkout/cart/sidebar/default.phtml</template></action>

                <action method="addItemRender"><type>bundle</type><block>bundle/checkout_cart_item_renderer</block><template>checkout/cart/sidebar/default.phtml</template></action>
            </block>
            <block type="ajaxpro/form_login" name="ajaxpro_customer_login" template="ajaxpro/customer/login.phtml" />
        </reference>

        <reference name="before_body_end">
            <block type="core/template" name="ajaxpro_init"           template="ajaxpro/init.phtml"/>

            <block type="core/template" name="ajaxpro_spinner"        template="ajaxpro/spinner.phtml"/>
            <block type="core/template" name="ajaxpro_notice"         template="ajaxpro/notice.phtml"/>
            <block type="core/template" name="ajaxpro_overlay"        template="ajaxpro/overlay.phtml"/>

            <block type="core/template" name="ajaxpro_product_form"   template="ajaxpro/product/form.phtml"/>
            <block type="core/template" name="ajaxpro_checkout_form"  template="ajaxpro/checkout/form.phtml"/>
            <block type="core/template" name="ajaxpro_compare_form"   template="ajaxpro/compare/form.phtml"/>
            <block type="core/template" name="ajaxpro_wishlist_form"  template="ajaxpro/wishlist/form.phtml"/>

        </reference>

    </default>

    <tm_ajaxpro_product_view>

        <update handle="catalog_product_view"/>
        <reference name="root">
            <action method="setTemplate"><template>page/empty.phtml</template></action>
        </reference>

        <reference name="product.info">
            <action method="setTemplate"><template>ajaxpro/product/info.phtml</template></action>
        </reference>

    </tm_ajaxpro_product_view>

    <tm_ajaxpro_catalog_view>
            <update handle="catalog_category_layered"/>
<!--        <remove name="product_list_toolbar" />-->
    </tm_ajaxpro_catalog_view>

    <!-- load javascript files and css style for browsing products on categories pages -->
    <tm_ajaxpro_catalog_product_view>
        <reference name="head">
            <action method="addJs"   ifconfig="ajax_pro/general/enabled"><script>varien/product.js</script></action>
            <action method="addItem" ifconfig="ajax_pro/general/enabled"><type>skin_js</type><name>js/bundle.js</name></action>
            <action method="addItem" ifconfig="ajax_pro/general/enabled"><type>js_css</type><name>calendar/calendar-win2k-1.css</name><params/><!--<if/><condition>can_load_calendar_js</condition>--></action>
            <action method="addItem" ifconfig="ajax_pro/general/enabled"><type>js</type><name>calendar/calendar.js</name><!--<params/><if/><condition>can_load_calendar_js</condition>--></action>
            <action method="addItem" ifconfig="ajax_pro/general/enabled"><type>js</type><name>calendar/calendar-setup.js</name><!--<params/><if/><condition>can_load_calendar_js</condition>--></action>
         </reference>
    </tm_ajaxpro_catalog_product_view>

    <cms_index_index>
        <update handle="tm_ajaxpro_catalog_product_view"/>
    </cms_index_index>

    <catalog_category_default>
        <update handle="tm_ajaxpro_catalog_product_view"/>
    </catalog_category_default>

    <catalogsearch_result_index>
        <update handle="tm_ajaxpro_catalog_product_view"/>
    </catalogsearch_result_index>

    <catalogsearch_advanced_result>
        <update handle="tm_ajaxpro_catalog_product_view"/>
    </catalogsearch_advanced_result>

    <catalog_category_layered>
        <update handle="tm_ajaxpro_catalog_product_view"/>

        <reference name="content">
            <block type="core/template" name="ajaxpro_list_toolbar" template="ajaxpro/list/toolbar.phtml"/>
        </reference>
    </catalog_category_layered>

    <checkout_cart_index>
        <reference name="before_body_end">
            <action method="unsetChild" ifconfig="ajax_pro/general/disabledOnShoppingCartPage">
                <name>ajaxpro_init</name>
            </action>
        </reference>
    </checkout_cart_index>

    <catalog_product_compare_index>
        <reference name="before_body_end">
            <action method="unsetChild">
                <name>ajaxpro_init</name>
            </action>
        </reference>
    </catalog_product_compare_index>
</layout>
